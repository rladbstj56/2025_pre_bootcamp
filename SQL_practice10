# https://nbc-precamp-data.oopy.io/29a2dc3e-f514-8116-9bb0-cf38a1466bcd

create table basic.employees(
	id int auto_increment primary key,
	department_id int,
	name varchar(5)
	)	   
	

insert into basic.employees (department_id, name)
values (101, '르탄이'),
	   (102, '배캠이'),
	   (103, '구구이'),
	   (101, '이션이')
	   
select * from employees	   
	
	
create table basic.departments(
	id int primary key,
	name varchar(5))
	
insert into basic.departments (id, name)
values (101, '인사'),
       (102, '마케팅팀'),
       (103, '기술팀')
       
select * from departments d left join employees e on d.id = e.department_id 


select count(*)
from departments;


select em.name, dp.name
from employees em 
inner join departments dp 
on em.department_id = dp.id;


select em.name, dp.name
from employees em inner join departments dp 
on em.department_id = dp.id
where dp.name = '기술팀';


select dp.id, dp.name, count(*)
from employees em inner join departments dp
on em.department_id = dp.id 
group by em.department_id, dp.name;


select dp.id, dp.name
from departments dp left join employees em
on em.department_id = dp.id 
group by dp.id, dp.name
# having count(*) = 0 ### 잘못된 코드 : 이렇게 하면 NULL인 행도 왼쪽 dp 테이블 정보로 한 행 포함되므로...
having count(em.id) = 0 ### 대신 사용할 코드!

select dp.name
from departments dp left join employees em
on em.department_id = dp.id 
where em.id is null ### 윗 쿼리 대신 사용할 정답 코드


select em.name
from employees em left join departments dp
on dp.id = em.department_id  
where dp.name = '마케팅팀'
